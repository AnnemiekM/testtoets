<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toets Landbouw en Voedselproductie</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); overflow: hidden; }
        .header { background: linear-gradient(135deg, #2e7d32, #4caf50); color: white; padding: 30px; text-align: center; position: relative; }
        .header h1 { font-size: 2em; margin-bottom: 10px; }
        .teacher-toggle { position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.2); border: 2px solid white; color: white; padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 14px; }
        .teacher-toggle:hover { background: white; color: #2e7d32; }
        .mode-indicator { position: absolute; top: 20px; left: 20px; background: rgba(255,255,255,0.2); padding: 8px 16px; border-radius: 20px; font-size: 14px; }
        .student-mode, .teacher-mode { display: none; }
        .student-mode.active, .teacher-mode.active { display: block; }
        .version-selector { padding: 20px; background: #f5f5f5; text-align: center; border-bottom: 1px solid #ddd; }
        .version-btn { background: #4caf50; color: white; border: none; padding: 12px 30px; margin: 0 10px; border-radius: 25px; cursor: pointer; font-size: 16px; transition: all 0.3s; }
        .version-btn:hover { background: #388e3c; transform: translateY(-2px); }
        .version-btn.active { background: #2e7d32; }
        .student-info { padding: 20px; background: #fafafa; border-bottom: 1px solid #ddd; }
        .student-info input { width: 200px; padding: 10px; margin: 5px 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px; }
        .quiz-container { padding: 30px; display: none; }
        .quiz-container.active { display: block; }
        .question { margin-bottom: 25px; padding: 20px; background: #f9f9f9; border-radius: 10px; border-left: 4px solid #4caf50; }
        .question h3 { color: #2e7d32; margin-bottom: 15px; font-size: 1.1em; }
        .options { display: flex; flex-direction: column; gap: 10px; }
        .option { display: flex; align-items: center; padding: 12px; background: white; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; transition: all 0.3s; }
        .option:hover { border-color: #4caf50; background: #f1f8e9; }
        .option input[type="radio"] { margin-right: 12px; transform: scale(1.2); }
        .submit-btn { background: linear-gradient(135deg, #4caf50, #2e7d32); color: white; border: none; padding: 15px 40px; font-size: 18px; border-radius: 25px; cursor: pointer; display: block; margin: 30px auto; transition: all 0.3s; }
        .submit-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4); }
        .result { display: none; padding: 30px; text-align: center; background: linear-gradient(135deg, #e8f5e8, #c8e6c9); border-radius: 15px; margin: 20px; }
        .result.show { display: block; }
        .score { font-size: 2.5em; font-weight: bold; color: #2e7d32; margin-bottom: 15px; }
        .feedback { font-size: 1.2em; color: #1b5e20; }
        .reset-btn { background: #ff9800; color: white; border: none; padding: 12px 25px; border-radius: 20px; cursor: pointer; margin-top: 20px; font-size: 16px; }
        .reset-btn:hover { background: #f57c00; }
        .teacher-panel { padding: 30px; }
        .teacher-nav { display: flex; gap: 15px; margin-bottom: 30px; border-bottom: 2px solid #e0e0e0; padding-bottom: 15px; }
        .teacher-nav-btn { background: #e0e0e0; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 16px; transition: all 0.3s; }
        .teacher-nav-btn.active { background: #4caf50; color: white; }
        .teacher-section { display: none; }
        .teacher-section.active { display: block; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: linear-gradient(135deg, #4caf50, #2e7d32); color: white; padding: 20px; border-radius: 10px; text-align: center; }
        .stat-number { font-size: 2em; font-weight: bold; margin-bottom: 5px; }
        .stat-label { font-size: 0.9em; opacity: 0.9; }
        .results-table { width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .results-table th { background: #4caf50; color: white; padding: 15px; text-align: left; font-weight: bold; }
        .results-table td { padding: 12px 15px; border-bottom: 1px solid #e0e0e0; }
        .results-table tr:hover { background: #f5f5f5; }
        .score-badge { padding: 4px 12px; border-radius: 15px; color: white; font-weight: bold; font-size: 0.9em; }
        .score-excellent { background: #4caf50; }
        .score-good { background: #ff9800; }
        .score-poor { background: #f44336; }
        .export-btn { background: #2196f3; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 16px; margin: 10px 5px; }
        .export-btn:hover { background: #1976d2; }
        .clear-btn { background: #f44336; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 16px; margin: 10px 5px; }
        .clear-btn:hover { background: #d32f2f; }
        @media (max-width: 768px) {
            .container { margin: 10px; border-radius: 10px; }
            .header { padding: 20px; }
            .header h1 { font-size: 1.5em; }
            .teacher-toggle, .mode-indicator { position: static; display: block; margin: 10px auto; }
            .student-info input { width: 150px; margin: 5px; }
            .teacher-nav { flex-wrap: wrap; }
            .stats-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="mode-indicator" id="modeIndicator">üë®‚Äçüéì Leerling Modus</div>
            <h1>üå± Toets Landbouw en Voedselproductie</h1>
            <p>VMBO Basis/Kader - Mens en Maatschappij</p>
            <button class="teacher-toggle" onclick="toggleTeacherMode()">üë®‚Äçüè´ Docent Paneel</button>
        </div>
        
        <!-- Student Mode -->
        <div class="student-mode active">
            <div class="version-selector">
                <h3>Selecteer toetsversie:</h3>
                <button class="version-btn active" onclick="selectQuizVersion('A')">Versie A</button>
                <button class="version-btn" onclick="selectQuizVersion('B')">Versie B (Herkansing)</button>
            </div>
            
            <div class="student-info">
                <label>Naam: <input type="text" id="studentName" placeholder="Vul je naam in"></label>
                <label>Klas: <input type="text" id="studentClass" placeholder="Bijv. 1A"></label>
            </div>
            
            <div id="quizA" class="quiz-container active"></div>
            <div id="quizB" class="quiz-container"></div>
            
            <button class="submit-btn" onclick="submitStudentQuiz()">Toets Inleveren</button>
            
            <div id="result" class="result">
                <div class="score" id="scoreDisplay"></div>
                <div class="feedback" id="feedbackText"></div>
                <button class="reset-btn" onclick="resetStudentQuiz()">Opnieuw Beginnen</button>
            </div>
        </div>
        
        <!-- Teacher Mode -->
        <div class="teacher-mode">
            <div class="teacher-panel">
                <div class="teacher-nav">
                    <button class="teacher-nav-btn active" onclick="showSection('overview')">üìä Overzicht</button>
                    <button class="teacher-nav-btn" onclick="showSection('results')">üìã Resultaten</button>
                    <button class="teacher-nav-btn" onclick="showSection('analysis')">üìà Analyse</button>
                    <button class="teacher-nav-btn" onclick="showSection('settings')">‚öôÔ∏è Beheer</button>
                </div>
                
                <div id="overview" class="teacher-section active">
                    <h2>üìä Toets Overzicht</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="totalStudents">0</div>
                            <div class="stat-label">Totaal Deelnemers</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="averageScore">0%</div>
                            <div class="stat-label">Gemiddelde Score</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="passRate">0%</div>
                            <div class="stat-label">Slagingspercentage</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="highestScore">0%</div>
                            <div class="stat-label">Hoogste Score</div>
                        </div>
                    </div>
                </div>
                
                <div id="results" class="teacher-section">
                    <h2>üìã Individuele Resultaten</h2>
                    <div style="margin-bottom: 20px;">
                        <button class="export-btn" onclick="exportToCSV()">üìÑ Exporteer naar CSV</button>
                        <button class="export-btn" onclick="printResultsTable()">üñ®Ô∏è Print Resultaten</button>
                    </div>
                    <table class="results-table">
                        <thead>
                            <tr><th>Naam</th><th>Klas</th><th>Versie</th><th>Score</th><th>Percentage</th><th>Tijd</th><th>Datum</th></tr>
                        </thead>
                        <tbody id="resultsTableBody"></tbody>
                    </table>
                </div>
                
                <div id="analysis" class="teacher-section">
                    <h2>üìà Vraag Analyse</h2>
                    <div id="questionAnalysis"></div>
                </div>
                
                <div id="settings" class="teacher-section">
                    <h2>‚öôÔ∏è Beheer & Instellingen</h2>
                    <div style="margin: 20px 0;">
                        <h3>Gegevens Beheer</h3>
                        <button class="clear-btn" onclick="clearAllData()">üóëÔ∏è Wis Alle Resultaten</button>
                        <button class="export-btn" onclick="backupResults()">üíæ Backup Gegevens</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const questionsA = [
            { question: "Wat is het verschil tussen akkerbouw en veeteelt?", options: ["Akkerbouw is binnen, veeteelt is buiten", "Akkerbouw is het telen van gewassen, veeteelt is het houden van dieren", "Akkerbouw is biologisch, veeteelt is gangbaar", "Er is geen verschil"], correct: 1 },
            { question: "Welke factor is het belangrijkst voor de groei van gewassen?", options: ["Alleen water", "Alleen zonlicht", "Water, zonlicht, voedingsstoffen en een goede bodem", "Alleen voedingsstoffen"], correct: 2 },
            { question: "Wat is kenmerkend voor biologische landbouw?", options: ["Gebruik van chemische bestrijdingsmiddelen", "Geen gebruik van kunstmest en chemische bestrijdingsmiddelen", "Alleen machines gebruiken", "Gewassen in kassen telen"], correct: 1 },
            { question: "Waarom wordt er mest gebruikt in de landbouw?", options: ["Om onkruid te bestrijden", "Om de bodem voedingsstoffen te geven", "Om insecten weg te houden", "Om het gewas sneller te laten groeien"], correct: 1 },
            { question: "Wat is vruchtwisseling?", options: ["Het wisselen van zaden", "Het afwisselen van verschillende gewassen op hetzelfde veld", "Het oogsten van fruit", "Het verkopen van gewassen"], correct: 1 },
            { question: "Welke dieren horen bij de veehouderij?", options: ["Koeien, varkens, kippen", "Honden, katten, konijnen", "Alleen koeien", "Wilde dieren"], correct: 0 },
            { question: "Wat is het voordeel van kassenteelt?", options: ["Goedkoper dan buitenteelt", "Bescherming tegen weer en ziekten, langere groeiperiode", "Minder werk", "Betere smaak"], correct: 1 },
            { question: "Welke Nederlandse regio is bekend om de bloementeelt?", options: ["Limburg", "Friesland", "Bollenstreek (Zuid-Holland)", "Groningen"], correct: 2 },
            { question: "Wat is duurzame landbouw?", options: ["Landbouw die alleen winst maakt", "Landbouw die rekening houdt met milieu en toekomst", "Landbouw zonder machines", "Landbouw alleen voor eigen gebruik"], correct: 1 },
            { question: "Welke stap komt het eerst in de voedselketen?", options: ["Transport naar de winkel", "Verwerking in de fabriek", "Productie op de boerderij", "Verkoop aan de consument"], correct: 2 }
        ];

        const questionsB = [
            { question: "Wat houdt veeteelt in?", options: ["Het telen van groenten", "Het fokken en houden van dieren voor voedsel", "Het maken van gereedschap", "Het bouwen van stallen"], correct: 1 },
            { question: "Welke voorwaarden hebben planten nodig om te groeien?", options: ["Alleen regenwater", "Zonlicht, water, voedingsstoffen en geschikte grond", "Alleen kunstmest", "Alleen zonneschijn"], correct: 1 },
            { question: "Wat kenmerkt gangbare landbouw?", options: ["Geen gebruik van machines", "Gebruik van kunstmest en chemische bestrijdingsmiddelen", "Alleen handwerk", "Gewassen telen zonder water"], correct: 1 },
            { question: "Waarvoor wordt kunstmest gebruikt?", options: ["Om dieren te voeren", "Om planten extra voedingsstoffen te geven", "Om water te besparen", "Om het weer te be√Ønvloeden"], correct: 1 },
            { question: "Waarom passen boeren vruchtwisseling toe?", options: ["Om de bodem gezond te houden en ziekten te voorkomen", "Om minder te hoeven werken", "Om meer geld te verdienen", "Om dieren te houden"], correct: 0 },
            { question: "Welke producten krijgen we van melkvee?", options: ["Alleen melk", "Melk, kaas, boter en vlees", "Alleen vlees", "Alleen eieren"], correct: 1 },
            { question: "Waarom gebruiken telers kassen?", options: ["Om minder water te gebruiken", "Om gewassen het hele jaar door te kunnen telen", "Om dieren te houden", "Om minder personeel nodig te hebben"], correct: 1 },
            { question: "Welk gewas is typisch voor de Nederlandse akkerbouw?", options: ["Rijst", "Aardappelen", "Bananen", "Koffie"], correct: 1 },
            { question: "Wat betekent lokale voedselproductie?", options: ["Voedsel produceren ver van huis", "Voedsel produceren in de buurt van waar het geconsumeerd wordt", "Voedsel alleen in fabrieken maken", "Voedsel importeren uit andere landen"], correct: 1 },
            { question: "Wat is de juiste volgorde in de voedselketen?", options: ["Winkel ‚Üí boerderij ‚Üí fabriek ‚Üí consument", "Boerderij ‚Üí fabriek ‚Üí winkel ‚Üí consument", "Fabriek ‚Üí boerderij ‚Üí consument ‚Üí winkel", "Consument ‚Üí winkel ‚Üí boerderij ‚Üí fabriek"], correct: 1 }
        ];

        let currentVersion = 'A';
        let currentQuestions = questionsA;
        let isTeacherMode = false;

        // Initialize when page loads
        window.onload = function() {
            generateQuiz();
            updateTeacherData();
        };

        function toggleTeacherMode() {
            isTeacherMode = !isTeacherMode;
            
            document.querySelector('.student-mode').classList.toggle('active', !isTeacherMode);
            document.querySelector('.teacher-mode').classList.toggle('active', isTeacherMode);
            
            const indicator = document.getElementById('modeIndicator');
            const toggle = document.querySelector('.teacher-toggle');
            
            if (isTeacherMode) {
                indicator.textContent = 'üë®‚Äçüè´ Docent Modus';
                toggle.textContent = 'üë®‚Äçüéì Leerling Modus';
                updateTeacherData();
            } else {
                indicator.textContent = 'üë®‚Äçüéì Leerling Modus';
                toggle.textContent = 'üë®‚Äçüè´ Docent Paneel';
            }
        }

        function selectQuizVersion(version) {
            currentVersion = version;
            currentQuestions = version === 'A' ? questionsA : questionsB;
            
            document.querySelectorAll('.version-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.getElementById('quizA').classList.toggle('active', version === 'A');
            document.getElementById('quizB').classList.toggle('active', version === 'B');
            
            document.getElementById('result').classList.remove('show');
            generateQuiz();
        }

        function generateQuiz() {
            const container = document.getElementById(`quiz${currentVersion}`);
            container.innerHTML = '';
            
            currentQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                
                const questionTitle = document.createElement('h3');
                questionTitle.textContent = `${index + 1}. ${q.question}`;
                questionDiv.appendChild(questionTitle);
                
                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'options';
                
                q.options.forEach((option, optIndex) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.className = 'option';
                    
                    const radio = document.createElement('input');
                    radio.type = 'radio';
                    radio.name = `q${index}`;
                    radio.value = optIndex;
                    radio.id = `q${index}_${optIndex}`;
                    
                    const label = document.createElement('label');
                    label.textContent = `${String.fromCharCode(97 + optIndex)}) ${option}`;
                    label.htmlFor = `q${index}_${optIndex}`;
                    
                    optionDiv.appendChild(radio);
                    optionDiv.appendChild(label);
                    optionsDiv.appendChild(optionDiv);
                    
                    optionDiv.addEventListener('click', () => radio.checked = true);
                });
                
                questionDiv.appendChild(optionsDiv);
                container.appendChild(questionDiv);
            });
        }

        function submitStudentQuiz() {
            const studentName = document.getElementById('studentName').value;
            const studentClass = document.getElementById('studentClass').value;
            
            if (!studentName || !studentClass) {
                alert('Vul eerst je naam en klas in!');
                return;
            }
            
            let score = 0;
            let answered = 0;
            let answers = [];
            
            currentQuestions.forEach((q, index) => {
                const selected = document.querySelector(`input[name="q${index}"]:checked`);
                if (selected) {
                    answered++;
                    const answer = parseInt(selected.value);
                    answers.push(answer);
                    if (answer === q.correct) score++;
                } else {
                    answers.push(-1);
                }
            });
            
            if (answered < currentQuestions.length) {
                alert(`Je hebt nog niet alle vragen beantwoord! (${answered}/${currentQuestions.length})`);
                return;
            }
            
            const percentage = Math.round((score / currentQuestions.length) * 100);
            
            const result = {
                name: studentName,
                class: studentClass,
                version: currentVersion,
                score: score,
                total: currentQuestions.length,
                percentage: percentage,
                answers: answers,
                timestamp: new Date().toISOString(),
                date: new Date().toLocaleDateString('nl-NL'),
                time: new Date().toLocaleTimeString('nl-NL')
            };
            
            saveQuizResult(result);
            
            document.getElementById('scoreDisplay').textContent = `${score}/${currentQuestions.length} (${percentage}%)`;
            
            let feedback = '';
            if (percentage >= 80) {
                feedback = `üéâ Uitstekend werk, ${studentName}! Je beheerst dit onderwerp heel goed.`;
            } else if (percentage >= 65) {
                feedback = `üëç Goed gedaan, ${studentName}! Je hebt een voldoende gehaald.`;
            } else {
                feedback = `üìö Helaas ${studentName}, dit is nog onvoldoende. Bestudeer de stof nog eens goed.`;
            }
            
            document.getElementById('feedbackText').textContent = feedback;
            document.getElementById('result').classList.add('show');
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        }

        function resetStudentQuiz() {
            document.querySelectorAll('input[type="radio"]').forEach(radio => radio.checked = false);
            document.getElementById('result').classList.remove('show');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function saveQuizResult(result) {
            let results = JSON.parse(localStorage.getItem('quizResults') || '[]');
            results.push(result);
            localStorage.setItem('quizResults', JSON.stringify(results));
        }

        function getQuizResults() {
            return JSON.parse(localStorage.getItem('quizResults') || '[]');
        }

        function showSection(section) {
            document.querySelectorAll('.teacher-nav-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.querySelectorAll('.teacher-section').forEach(sec => sec.classList.remove('active'));
            document.getElementById(section).classList.add('active');
            
            if (section === 'overview') updateOverviewStats();
            if (section === 'results') updateResultsTable();
            if (section === 'analysis') updateAnalysisSection();
        }

        function updateTeacherData() {
            updateOverviewStats();
            updateResultsTable();
            updateAnalysisSection();
        }

        function updateOverviewStats() {
            const results = getQuizResults();
            const totalStudents = results.length;
            
            if (totalStudents === 0) {
                document.getElementById('totalStudents').textContent = '0';
                document.getElementById('averageScore').textContent = '0%';
                document.getElementById('passRate').textContent = '0%';
                document.getElementById('highestScore').textContent = '0%';
                return;
            }
            
            const averageScore = Math.round(results.reduce((sum, r) => sum + r.percentage, 0) / totalStudents);
            const passCount = results.filter(r => r.percentage >= 65).length;
            const passRate = Math.round((passCount / totalStudents) * 100);
            const highestScore = Math.max(...results.map(r => r.percentage));
            
            document.getElementById('totalStudents').textContent = totalStudents;
            document.getElementById('averageScore').textContent = averageScore + '%';
            document.getElementById('passRate').textContent = passRate + '%';
            document.getElementById('highestScore').textContent = highestScore + '%';
        }

        function updateResultsTable() {
            const results = getQuizResults();
            const tbody = document.getElementById('resultsTableBody');
            tbody.innerHTML = '';
            
            results.forEach(result => {
                const row = document.createElement('tr');
                let scoreBadgeClass = 'score-poor';
                if (result.percentage >= 80) scoreBadgeClass = 'score-excellent';
                else if (result.percentage >= 65) scoreBadgeClass = 'score-good';
                
                row.innerHTML = `
                    <td>${result.name}</td>
                    <td>${result.class}</td>
                    <td>Versie ${result.version}</td>
                    <td>${result.score}/${result.total}</td>
                    <td><span class="score-badge ${scoreBadgeClass}">${result.percentage}%</span></td>
                    <td>${result.time}</td>
                    <td>${result.date}</td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateAnalysisSection() {
            const results = getQuizResults();
            const analysisContainer = document.getElementById('questionAnalysis');
            analysisContainer.innerHTML = '';
            
            if (results.length === 0) {
                analysisContainer.innerHTML = '<p>Nog geen resultaten beschikbaar voor analyse.</p>';
                return;
            }
            
            // Create answer matrix
            const matrixDiv = document.createElement('div');
            matrixDiv.innerHTML = '<h3>üìä Antwoord Matrix</h3>';
            
            const table = document.createElement('table');
            table.className = 'results-table';
            table.style.marginBottom = '30px';
            
            // Header row
            const headerRow = document.createElement('tr');
            headerRow.innerHTML = '<th>Leerling</th><th>Klas</th><th>Versie</th>';
            for (let i = 1; i <= 10; i++) {
                const th = document.createElement('th');
                th.textContent = `V${i}`;
                th.style.textAlign = 'center';
                th.style.minWidth = '40px';
                headerRow.appendChild(th);
            }
            const totalTh = document.createElement('th');
            totalTh.textContent = 'Score';
            headerRow.appendChild(totalTh);
            table.appendChild(headerRow);
            
            // Student rows
            results.forEach(result => {
                const row = document.createElement('tr');
                row.innerHTML = `<td><strong>${result.name}</strong></td><td>${result.class}</td><td>V${result.version}</td>`;
                
                const questions = result.version === 'A' ? questionsA : questionsB;
                for (let i = 0; i < 10; i++) {
                    const td = document.createElement('td');
                    td.style.textAlign = 'center';
                    td.style.fontWeight = 'bold';
                    td.style.padding = '8px';
                    
                    if (result.answers && result.answers[i] !== undefined && result.answers[i] !== -1) {
                        const isCorrect = result.answers[i] === questions[i].correct;
                        if (isCorrect) {
                            td.textContent = '‚úì';
                            td.style.backgroundColor = '#4caf50';
                            td.style.color = 'white';
                        } else {
                            td.textContent = '‚úó';
                            td.style.backgroundColor = '#f44336';
                            td.style.color = 'white';
                        }
                    } else {
                        td.textContent = '-';
                        td.style.backgroundColor = '#9e9e9e';
                        td.style.color = 'white';
                    }
                    
                    row.appendChild(td);
                }
                
                // Total score
                const scoreTd = document.createElement('td');
                scoreTd.style.textAlign = 'center';
                scoreTd.style.fontWeight = 'bold';
                let scoreBadgeClass = 'score-poor';
                if (result.percentage >= 80) scoreBadgeClass = 'score-excellent';
                else if (result.percentage >= 65) scoreBadgeClass = 'score-good';
                scoreTd.innerHTML = `<span class="score-badge ${scoreBadgeClass}">${result.score}/10</span>`;
                row.appendChild(scoreTd);
                
                table.appendChild(row);
            });
            
            matrixDiv.appendChild(table);
            
            // Add legend
            const legend = document.createElement('div');
            legend.style.marginBottom = '30px';
            legend.innerHTML = `
                <h4>Legenda:</h4>
                <div style="display: flex; gap: 20px; align-items: center; margin-top: 10px;">
                    <span style="background: #4caf50; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;">‚úì Correct</span>
                    <span style="background: #f44336; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;">‚úó Onjuist</span>
                    <span style="background: #9e9e9e; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;">- Niet beantwoord</span>
                </div>
            `;
            matrixDiv.appendChild(legend);
            
            analysisContainer.appendChild(matrixDiv);
        }

        function exportToCSV() {
            const results = getQuizResults();
            if (results.length === 0) {
                alert('Geen resultaten om te exporteren!');
                return;
            }
            
            let csv = 'Naam,Klas,Versie,Score,Totaal,Percentage,Tijd,Datum\n';
            results.forEach(result => {
                csv += `"${result.name}","${result.class}","${result.version}",${result.score},${result.total},${result.percentage}%,"${result.time}","${result.date}"\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'toets_resultaten_landbouw.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function printResultsTable() {
            const results = getQuizResults();
            if (results.length === 0) {
                alert('Geen resultaten om te printen!');
                return;
            }
            
            let printContent = `
                <h1>Toets Resultaten - Landbouw en Voedselproductie</h1>
                <p>Datum: ${new Date().toLocaleDateString('nl-NL')}</p>
                <table border="1" style="border-collapse: collapse; width: 100%;">
                    <tr>
                        <th>Naam</th>
                        <th>Klas</th>
                        <th>Versie</th>
                        <th>Score</th>
                        <th>Percentage</th>
                        <th>Datum</th>
                    </tr>
            `;
            
            results.forEach(result => {
                printContent += `
                    <tr>
                        <td>${result.name}</td>
                        <td>${result.class}</td>
                        <td>${result.version}</td>
                        <td>${result.score}/${result.total}</td>
                        <td>${result.percentage}%</td>
                        <td>${result.date}</td>
                    </tr>
                `;
            });
            
            printContent += '</table>';
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.print();
        }

        function clearAllData() {
            if (confirm('Weet je zeker dat je alle resultaten wilt wissen? Dit kan niet ongedaan worden gemaakt.')) {
                localStorage.removeItem('quizResults');
                updateTeacherData();
                alert('Alle resultaten zijn gewist.');
            }
        }

        function backupResults() {
            const data = {
                results: getQuizResults(),
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'toets_backup_landbouw.json';
            a.click();
            window.URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>